# Neo4j + Vertex AI Codelab

A movie recommendation application that combines Neo4j's graph database capabilities with Google Cloud's Vertex AI for semantic search and natural language movie recommendations.

## üöÄ Overview

This project demonstrates how to build an AI-powered movie recommendation engine using:

- **Neo4j**: Graph database for storing comprehensive movie data and vector embeddings of movie plots/overviews
  * Stores movie metadata (title, release date, runtime, ratings)
  * Actor and director information with relationships to movies
  * Genre classifications and other categorical data
  * Production companies and countries
  * Vector embeddings for semantic search capabilities
- **Google Vertex AI**: For generating vector embeddings and performing semantic search
  * Generates vector embeddings from movie plots/overviews
  * Powers semantic search functionality
  * Provides natural language understanding for query processing
  * Enables similarity-based movie recommendations
- **Gradio**: For building an interactive web interface to query and visualize results

The system uses semantic search through vector embeddings generated by Vertex AI's text-embedding models to find movies based on natural language queries, and then leverages Gemini to produce conversational responses.

## üß© How It Works

1. **Data Processing**: Movie data is loaded into Neo4j graph database
2. **Vector Embeddings**: Text embeddings are generated for movie descriptions using Vertex AI
3. **Vector Search**: Semantic similarity is used to match user queries with relevant movies
4. **Natural Language Processing**: Gemini generates human-like responses based on the matches

## üóÇÔ∏è Repository Structure

- `chatbot.py`: Main application with Gradio interface for movie recommendations
- `generate_embeddings.py`: Script to generate vector embeddings for movie data
- `graph_build.py`: Script to populate Neo4j with movie data
- `example.env`: Template for environment variables
- `normalized_data/`: Directory containing movie data

## ‚öôÔ∏è Setup and Installation

### Prerequisites

- Python 3.7+
- Neo4j database (can be self-hosted or Aura DB)
- Google Cloud account with Vertex AI API enabled
- Service account with appropriate permissions for Vertex AI

### Environment Configuration

1. Clone this repository
2. Copy `example.env` to `.env` and fill in your configuration:
   ```
   NEO4J_URI = your-neo4j-connection-string
   NEO4J_USER = your-neo4j-username
   NEO4J_PASSWORD = your-neo4j-password
   PROJECT_ID = your-gcp-project-id
   LOCATION = your-gcp-location
   GOOGLE_CLOUD_PROJECT = your-gcp-project-id
   ```
3. Create a service account in Google Cloud and download the JSON key file
4. Place the service account key in the project directory (referenced in `generate_embeddings.py`)

### Installation

```bash
# Create and activate a virtual environment (recommended)
python -m venv venv
source venv/bin/activate  # On Windows: venv\\Scripts\\activate

# Install dependencies
pip install neo4j vertexai gradio langchain_google_vertexai python-dotenv
```

## üèÉ‚Äç‚ôÄÔ∏è Running the Application

### 1. Build the Graph Database

First, load movie data into Neo4j:

```bash
python graph_build.py
```

### 2. Generate Embeddings

Generate vector embeddings for movie descriptions:

```bash
python generate_embeddings.py
```

### 3. Start the Recommender

Launch the Gradio web interface:

```bash
python chatbot.py
```

The application will be available at `http://localhost:7860` by default.

## üß™ Example Queries

- "I want to watch a sci-fi movie with time travel"
- "Recommend me a romantic comedy with a happy ending"
- "I'm in the mood for something with superheroes but not too serious"
- "I want a thriller that keeps me on the edge of my seat"
- "Show me movies about artificial intelligence taking over the world"

## üìö Learning Resources

- [Neo4j Vector Search Documentation](https://neo4j.com/docs/cypher-manual/current/indexes-for-vector-search/)
- [Vertex AI Embeddings](https://cloud.google.com/vertex-ai/docs/generative-ai/embeddings/get-text-embeddings)
- [Gemini API](https://cloud.google.com/vertex-ai/docs/generative-ai/model-reference/gemini)
- [Gradio Documentation](https://gradio.app/docs/)

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## üìÑ License

This project is licensed under the MIT License - see the LICENSE file for details.
